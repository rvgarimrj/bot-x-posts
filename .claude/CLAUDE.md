<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>

# Bot-X-Posts - Regras e Configuracoes

## Visao Geral

Bot automatizado para postar no X (Twitter) via Puppeteer conectado ao Chrome em modo debug. Gera posts bilingues (EN + PT-BR) sobre crypto, investing, AI e vibeCoding usando curadoria multi-fonte + Claude.

## Arquitetura V2 (Multi-Source Bilingual)

```
Cron (8h,10h,12h,14h,16h,18h,20h - Daily)
    │
    ▼
┌─────────────────────────────────────────────────┐
│              CURATE-V3 (Orquestrador)           │
│                                                 │
│  Para cada topico, busca em paralelo:          │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │ Fonte 1 │ │ Fonte 2 │ │ Fonte 3 │           │
│  └────┬────┘ └────┬────┘ └────┬────┘           │
│       └───────────┼───────────┘                 │
│                   ▼                             │
│            Cache Manager                        │
│       (fresh 30min, stale 4h)                  │
└─────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────┐
│           CLAUDE-V2 (Analise + Geracao)         │
│                                                 │
│  • Analisa sentiment/narrativa                  │
│  • Gera 2 posts por topico (EN + PT-BR)        │
│  • System prompts diferentes por idioma        │
│  • 8 estilos x 8 hooks = 64 combinacoes        │
└─────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────┐
│            TELEGRAM PREVIEW (2 min)             │
│         8 posts com botao de cancelar          │
└─────────────────────────────────────────────────┘
    │
    ▼
┌─────────────────────────────────────────────────┐
│         PUPPETEER POST (60s entre posts)        │
│      Digitacao humanizada, Chrome debug        │
└─────────────────────────────────────────────────┘
```

## Horarios e Topicos (TODOS OS DIAS)

| Horario | Posts | Topicos | Idiomas |
|---------|-------|---------|---------|
| 8h | 8 | crypto, investing, ai, vibeCoding | EN + PT-BR |
| 10h | 8 | crypto, investing, ai, vibeCoding | EN + PT-BR |
| 12h | 8 | crypto, investing, ai, vibeCoding | EN + PT-BR |
| 14h | 8 | crypto, investing, ai, vibeCoding | EN + PT-BR |
| 16h | 8 | crypto, investing, ai, vibeCoding | EN + PT-BR |
| 18h | 8 | crypto, investing, ai, vibeCoding | EN + PT-BR |
| 20h | 8 | crypto, investing, ai, vibeCoding | EN + PT-BR |

**Total:** 56 posts/dia x 7 dias = 392 posts/semana

## Arquivos Principais

### V2 (Novo - Multi-Source Bilingual)
| Arquivo | Funcao |
|---------|--------|
| `scripts/cron-daemon-v2.js` | Daemon V2: 7 horarios, todos os dias |
| `scripts/auto-post-v2.js` | Fluxo V2: 8 posts (4 topicos x 2 idiomas) |
| `src/curate-v3.js` | Curadoria multi-fonte com fallback chains |
| `src/claude-v2.js` | Geracao bilingue (EN + PT-BR) + Hook Frameworks |
| `src/sources/` | Modulos de fontes de dados |

### V1 (Legacy)
| Arquivo | Funcao |
|---------|--------|
| `scripts/cron-daemon.js` | Daemon V1: 4 horarios, Seg-Sab |
| `scripts/auto-post.js` | Fluxo V1: 3 posts por horario |
| `src/curate-v2.js` | Curadoria com Twitter API |
| `src/claude.js` | Geracao PT-BR apenas |

### Comum
| Arquivo | Funcao |
|---------|--------|
| `src/puppeteer-post.js` | Posta no X via Chrome debug |
| `src/telegram-v2.js` | Notificacoes Telegram |

## Fontes de Dados por Topico (V2)

### CRYPTO
| Prioridade | Fonte | Rate Limit | Dados |
|------------|-------|------------|-------|
| Primary | CoinGecko | 30/min | BTC/ETH precos, Fear&Greed, trending |
| Primary | Reddit r/cryptocurrency | 60/min | Hot posts, sentiment |
| Fallback | RSS (CoinTelegraph, CryptoNews) | Ilimitado | Noticias |

### INVESTING
| Prioridade | Fonte | Rate Limit | Dados |
|------------|-------|------------|-------|
| Primary | Finnhub | 60/min | Noticias, earnings |
| Primary | Reddit r/stocks, r/wallstreetbets | 60/min | Hot posts, tickers |
| Fallback | RSS (MarketWatch) | Ilimitado | Noticias |

### AI
| Prioridade | Fonte | Rate Limit | Dados |
|------------|-------|------------|-------|
| Primary | HuggingFace Hub | Ilimitado | Modelos trending |
| Primary | Reddit r/MachineLearning, r/ChatGPT | 60/min | Discussoes |
| Secondary | arXiv API | 3/sec | Papers recentes |
| Fallback | RSS (TechCrunch AI) | Ilimitado | Noticias |

### VIBECODING
| Prioridade | Fonte | Rate Limit | Dados |
|------------|-------|------------|-------|
| Primary | HackerNews | Ilimitado | Top stories |
| Primary | GitHub API | 60/hora | Repos trending |
| Secondary | Reddit r/Cursor, r/LocalLLaMA | 60/min | Discussoes |
| Fallback | RSS (Dev.to) | Ilimitado | Artigos |

## Configuracoes Criticas

### Chrome Debug Mode
Chrome DEVE rodar com:
```bash
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome \
  --remote-debugging-port=9222 \
  --disable-background-timer-throttling \
  --disable-backgrounding-occluded-windows \
  --disable-renderer-backgrounding
```

### LaunchAgent (Daemon)
Arquivo: `~/Library/LaunchAgents/com.botxposts.daemon.plist`
- Chama `/usr/local/bin/node scripts/cron-daemon.js` diretamente
- WorkingDirectory: `/Users/user/AppsCalude/Bot-X-Posts`
- KeepAlive com SuccessfulExit: false (reinicia apenas em crash)
- ThrottleInterval: 30 segundos

### Caminhos Absolutos
**IMPORTANTE:** Quando spawn processos via launchd, SEMPRE usar caminho absoluto:
- Node: `/usr/local/bin/node` (NAO apenas `node`)

### Anti-Timeout (Mac Sleep)
- App Nap desativado para Chrome: `defaults write com.google.Chrome NSAppSleepDisabled -bool YES`
- ProcessType: Interactive no plist
- Timeouts configurados: 60s page, 120s protocol

## Curadoria v2

### Fontes de Dados
- **CoinGecko:** Preco BTC/ETH, Fear & Greed Index, trending coins
- **Twitter API:** Busca trending com extracao de autores, hashtags e mentions
- **Hacker News:** Top stories para vibeCoding
- **Claude:** Analise de sentimento, narrativas e angulos sugeridos

### Dados Extraidos do X (TODOS os topicos)

Para **crypto**, **investing** e **vibeCoding**, o sistema extrai:

| Dado | Descricao | Uso |
|------|-----------|-----|
| `topTweets` | Tweets ordenados por velocidade viral | Contexto para Claude |
| `trendingHashtags` | Hashtags mais usadas nos tweets | Incluir no post |
| `topAuthors` | @usuarios + followers dos tweets virais | Referenciar no post |
| `topMentions` | @contas mais mencionadas | Referenciar no post |
| `influencers` | Lista pre-definida por nicho | Sugestao de mencao |

### Queries de Busca por Topico

```javascript
crypto: 'Bitcoin OR #BTC OR #crypto -filter:retweets'
investing: 'stocks OR #SP500 OR $NVDA OR $TSLA -filter:retweets'
vibeCoding: 'Claude Code OR Cursor AI OR "vibe coding" OR "AI coding" -filter:retweets'
```

### Influencers Pre-definidos

```javascript
crypto: ['@sabortoothpete', '@CryptoCapo_', '@WClementeIII', '@documentingbtc', '@BitcoinMagazine']
investing: ['@jimcramer', '@StockMKTNewz', '@unusual_whales', '@DeItaone', '@zaborowski']
vibeCoding: ['@kaborowski', '@alexalbert__', '@cursor_ai', '@AnthropicAI', '@OpenAI']
```

### Prompt para Geracao de Posts

O `formatForPrompt()` envia para Claude:
```
DADOS EM TEMPO REAL:
- BTC: $83000 (-0.5%)
- Fear & Greed: 20 (Extreme Fear)

SENTIMENTO DO X: mixed (score: -15)
NARRATIVA DOMINANTE: Bitcoin consolidando enquanto mercado em medo

HASHTAGS EM ALTA: #Bitcoin #crypto #BTC
CONTAS ATIVAS: @StckStratgy (8247), @cryptogallant (1750)
MAIS MENCIONADOS: @Bitcoin, @elenakvcs
INFLUENCERS DO NICHO: @CryptoCapo_, @BitcoinMagazine

TWEETS VIRAIS NO MOMENTO:
1. [45.2/h por @usuario] "texto do tweet..."

INSTRUÇÕES EXTRAS:
- Use 1-2 hashtags relevantes do trending
- Se fizer sentido, mencione ou referencie uma conta ativa
- Mantenha o tom autêntico e não pareça bot
```

### Rate Limits e Cache

| Config | Valor | Motivo |
|--------|-------|--------|
| Cache fresco | 60 min | Evita requests repetidos |
| Cache stale | 4 horas | Fallback quando rate limited |
| Delay entre buscas | 5 segundos | Evita rate limit |
| Queries por topico | 1 (com OR) | Menos requests |
| Deteccao rate limit | Automatica | Para de tentar por 15min |

### IMPORTANTE: O que os Cron Jobs DEVEM fazer

1. **Curadoria v2** busca dados frescos + trending do X
2. **Extrair** hashtags, autores e mentions dos tweets virais
3. **Passar** esses dados para o Claude via `formatForPrompt()`
4. **Claude gera** posts usando hashtags trending e referencias a contas
5. **Posts incluem** 1-2 hashtags relevantes e podem mencionar contas ativas

## Comandos Uteis

```bash
# ===== V2 (Recomendado) =====

# Iniciar daemon V2
npm run start:v2

# Testar uma source individual
node scripts/test-source.js coingecko
node scripts/test-source.js reddit investing
node scripts/test-source.js finnhub
node scripts/test-source.js hackernews
node scripts/test-source.js github
node scripts/test-source.js huggingface

# Testar curadoria V3
node scripts/test-curate-v3.js              # Todos os topicos
node scripts/test-curate-v3.js crypto       # Topico especifico

# Testar geracao bilingue
node scripts/test-generate-v2.js            # Todos
node scripts/test-generate-v2.js crypto en  # Especifico

# Rodar ciclo completo (dry-run)
node scripts/auto-post-v2.js

# ===== V1 (Legacy) =====

# Status do daemon V1
launchctl list | grep bot

# Ver logs
tail -f logs/daemon.log
tail -f logs/daemon-error.log

# Reiniciar daemon V1
pkill -9 -f "cron-daemon"
launchctl unload ~/Library/LaunchAgents/com.botxposts.daemon.plist
launchctl load ~/Library/LaunchAgents/com.botxposts.daemon.plist

# Testar post manual V1
node scripts/auto-post.js vibeCoding

# ===== Comum =====

# Verificar Chrome conectado
curl -s http://localhost:9222/json/version
```

## Problemas Conhecidos e Solucoes

| Problema | Causa | Solucao |
|----------|-------|---------|
| `spawn node ENOENT` | PATH nao disponivel no launchd | Usar `/usr/local/bin/node` |
| Daemons duplicados | plist reiniciando rapido | ThrottleInterval + KeepAlive config |
| Telegram 409 Conflict | Multiplas instancias polling | Garantir apenas 1 daemon |
| Aba X nao encontrada | Chrome sem X.com aberto | Codigo abre automaticamente |
| Timeout com tela bloqueada | App Nap / throttling | Flags anti-suspensao no Chrome |
| Twitter rate limit | Muitas requisicoes | Cache de 15 min, fallback |
| Post truncado (so ultimo paragrafo) | execCommand em chunks sobrescreve | Usar clipboard (Cmd+V) |
| Daemon crash silencioso | `.catch()` em funcao sync | Usar try/catch para unlinkSync |

## Fluxo de Postagem (V2)

1. Cron dispara a cada 2h (8h-20h, todos os dias)
2. `curateContentV3()` busca de multiplas fontes em paralelo
3. Fallback chain: Primary -> Secondary -> RSS
4. `generatePost()` gera 8 posts (4 topicos x 2 idiomas)
5. Preview enviado no Telegram (2 min para cancelar)
6. `postTweet()` digita no X como humano (delays variaveis)
7. 60s entre cada post (total ~12 min por slot)
8. Confirmacao no Telegram

## Diferenciacao EN vs PT-BR

### Posts em Ingles
- System prompt: Global developer perspective
- Hashtags: #AI #VibeCoding #ClaudeCode #Cursor
- Tom: Tecnico, direto, internacional

### Posts em Portugues
- System prompt: @garim (prompt original)
- Hashtags: #DevBR #ClaudeCode #Cursor #VibeCoding
- Tom: Pratico, conversacional, brasileiro

**IMPORTANTE:** Ambos na mesma conta @garim, intercalados. NAO sao traducoes - Claude gera independentemente.

## Sistema de Variedade: Styles + Hook Frameworks

O `claude-v2.js` implementa um sistema de variedade para evitar posts repetitivos. Cada post e gerado com uma combinacao aleatoria de **STYLE** (tom) e **HOOK** (estrutura de abertura).

### POST_STYLES (8 estilos de tom)

| Style | EN | PT-BR |
|-------|----|----|
| `hot_take` | Strong opinion, controversial | Opiniao forte, controversa |
| `observation` | Casual "just realized..." | "acabei de perceber..." |
| `question` | Genuine question to followers | Pergunta genuina |
| `reaction` | Emotional reaction (surprise, frustration) | Reacao emocional |
| `tip` | Quick useful tip, not preachy | Dica rapida, sem parecer coach |
| `sarcasm` | Light ironic humor | Humor ironico leve |
| `personal` | What YOU are doing/thinking | O que VOCE ta fazendo |
| `contrarian` | Go against the crowd | Vai contra a manada |

### HOOK_FRAMEWORKS (8 estruturas de abertura)

| Hook | Descricao | Exemplo EN | Exemplo PT-BR |
|------|-----------|------------|---------------|
| `extreme` | Extremos: best/worst/most ever | "worst crash ive seen this year" | "pior crash que vi esse ano" |
| `aida` | Attention-Interest-Desire-Action | "most devs waste hours on X. i did too. then i found Y" | "maioria dos devs perde horas com X. eu tambem perdia" |
| `pas` | Problem-Agitate-Solution | "context switching kills your flow. been there. this fixed it" | "trocar de contexto mata seu flow. ja passei por isso" |
| `bab` | Before-After-Bridge (transformacao) | "used to spend 3h debugging. now 20min. the trick?" | "gastava 3h debugando. agora 20min. o truque?" |
| `emotional` | Lead with raw emotion | "almost rage-quit yesterday. then realized..." | "quase larguei tudo ontem. dai percebi..." |
| `results` | Lead with results achieved | "shipped 3 features today instead of 1. heres my setup" | "entreguei 3 features hoje ao inves de 1. meu setup" |
| `client` | Third-party proof (friend/colleague) | "friend asked me to review his code. found this gem" | "amigo pediu pra revisar codigo dele. achei essa perola" |
| `idea` | One powerful standalone line | "AI wont replace devs. devs using AI will replace devs not using it" | "AI nao vai substituir dev. dev usando AI vai substituir dev sem AI" |

### Combinacao STYLE + HOOK = 64 variacoes

O sistema combina **8 styles x 8 hooks = 64 combinacoes possiveis** para cada idioma.

Exemplos de combinacoes:
- `hot_take + extreme` = "hot take: worst AI tool ive ever used is..."
- `sarcasm + bab` = "used to be productive. then discovered twitter. now..."
- `personal + results` = "just shipped 3 PRs today. my secret? turn off slack"
- `contrarian + emotional` = "everyone hyped about X and im here worried..."

### Log Output

Durante a geracao, o sistema loga a combinacao escolhida:

```
   Gerando: crypto (en)...
      [style: hot_take + hook: extreme]
   Gerando: crypto (pt-BR)...
      [style: reaction + hook: pas]
   Gerando: investing (en)...
      [style: contrarian + hook: bab]
```

### Por que isso importa

1. **Evita deteccao de bot** - Posts variam em estrutura e tom
2. **Parece mais humano** - Pessoas reais alternam entre estilos
3. **Melhora engajamento** - Diferentes hooks funcionam para diferentes momentos
4. **Escalabilidade** - 64 combinacoes x 4 topicos x 2 idiomas = alta variedade

### Implementacao tecnica

```javascript
// Em generatePost()
const randomStyle = styles[Math.floor(Math.random() * styles.length)]
const randomHook = hooks[Math.floor(Math.random() * hooks.length)]
console.log(`      [style: ${randomStyle.name} + hook: ${randomHook.name}]`)

// Prompt inclui ambos:
// TONE/STYLE: ${randomStyle.instruction}
// HOOK FRAMEWORK: ${randomHook.instruction}
// HOOK EXAMPLES: ${randomHook.examples.join(' | ')}
```

## Sistema de Auto-Aprendizado (Self-Learning)

O bot aprende automaticamente quais combinacoes de HOOK + STYLE geram mais engajamento.

### Arquivos do Sistema
| Arquivo | Funcao |
|---------|--------|
| `src/analytics-monitor.js` | Coleta metricas diarias do X Analytics |
| `src/learning-engine.js` | Analisa performance, ajusta pesos |
| `scripts/daily-analysis.js` | Roda as 23:59, gera relatorios |
| `data/learnings.json` | Scores e pesos por hook/style/topico |
| `logs/daily-reports/` | Relatorios diarios em JSON |

### Fluxo de Aprendizado
```
Dia 1: Posts com selecao aleatoria
         ↓
23:59: Analise coleta engajamento
         ↓
       Learning engine identifica:
       - "extreme + hot_take" → alto engajamento → peso 1.4
       - "tip + idea" → baixo engajamento → peso 0.7
         ↓
Dia 2: Posts com pesos ajustados (mais do que funciona)
```

### Metas Monitoradas
| Meta | Valor | Para que |
|------|-------|----------|
| Impressoes | 5M em 3 meses | Partilha de Receitas |
| Premium Followers | 500 | Partilha de Receitas |
| Verified Followers | 2,000 | Subscricoes |

### Comandos
```bash
npm run analyze          # Rodar analise manual
npm run learn            # Ciclo completo de aprendizado
cat data/learnings.json  # Ver pesos atuais
```

## Sistema de Auto-Aprendizado V2

Sistema inteligente que aprende automaticamente quais combinacoes de HOOK + STYLE + TOPIC + HOUR geram mais engajamento, ajustando pesos dinamicamente para atingir metas de monetizacao.

### Metas do Projeto (Creator Studio)

| Programa | Impressoes | Followers | Deadline | Meta Diaria |
|----------|------------|-----------|----------|-------------|
| **Partilha de Receitas** | 5M | 500 premium | 90 dias | ~55k impressoes/dia |
| **Subscricoes** | 5M | 2,000 verified | 90 dias | ~55k impressoes/dia |

**Calculo da meta diaria:** 5,000,000 / 90 dias = ~55,556 impressoes/dia

### Ciclo Diario Automatico

```
┌─────────────────────────────────────────────────────────────┐
│                    CICLO DIARIO 24H                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  00:01  Health Check                                        │
│         - Verifica Chrome conectado                         │
│         - Verifica daemon rodando                           │
│         - Alerta no Telegram se problema                    │
│                                                             │
│  00:05  Restart Diario do Daemon                            │
│         - Limpa memoria                                     │
│         - Recarrega configuracoes                           │
│         - Aplica novos pesos aprendidos                     │
│                                                             │
│  08:00-20:00  Posts com Horarios Dinamicos                  │
│         - Baseado em engagement-hours.json                  │
│         - Mais posts nos horarios de alto engagement        │
│         - Menos posts nos horarios de baixo engagement      │
│                                                             │
│  23:59  Analise + Learning + Relatorio                      │
│         - Coleta metricas do dia                            │
│         - Compara com metas                                 │
│         - Ajusta pesos para proximo dia                     │
│         - Envia relatorio no Telegram                       │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Sistema de Aprendizado

O learning engine rastreia e ajusta pesos para 5 dimensoes:

| Dimensao | Descricao | Exemplo de Ajuste |
|----------|-----------|-------------------|
| **Hooks** | Framework de abertura | `extreme: 1.3` (mais usado) |
| **Styles** | Tom do post | `hot_take: 1.2` (engaja mais) |
| **Topics** | Tema do conteudo | `crypto: 1.4` (trending) |
| **Hours** | Horario de postagem | `18h: 1.5` (pico de engagement) |
| **Experiments** | A/B tests | `emoji_start: 0.8` (nao funcionou) |

### Ajuste Automatico de Pesos

```javascript
// Formula de ajuste
newWeight = currentWeight * (1 + (engagementRate - avgEngagement) * learningRate)

// Limites
MIN_WEIGHT = 0.3  // Nunca para de usar completamente
MAX_WEIGHT = 2.0  // Nunca domina completamente
LEARNING_RATE = 0.1  // Ajustes graduais
```

### Arquivos do Sistema V2

| Arquivo | Funcao |
|---------|--------|
| `src/engagement-analyzer.js` | Analisa melhores horarios baseado em dados reais |
| `src/telegram-report.js` | Formata e envia relatorios diarios |
| `scripts/daily-learning.js` | Executa ciclo completo de aprendizado |
| `scripts/daemon-manager.js` | Gerencia start/stop/restart do daemon |
| `data/GOALS.md` | Metas e acompanhamento de progresso |
| `data/engagement-hours.json` | Pesos por horario baseado em engagement |
| `data/learnings.json` | Todos os pesos aprendidos |
| `logs/daily-reports/` | Historico de relatorios diarios |

### Estrutura do engagement-hours.json

```json
{
  "hours": {
    "8": { "weight": 1.0, "avgEngagement": 450, "samples": 28 },
    "10": { "weight": 1.2, "avgEngagement": 580, "samples": 28 },
    "12": { "weight": 0.9, "avgEngagement": 380, "samples": 28 },
    "14": { "weight": 1.1, "avgEngagement": 520, "samples": 28 },
    "16": { "weight": 1.3, "avgEngagement": 650, "samples": 28 },
    "18": { "weight": 1.5, "avgEngagement": 820, "samples": 28 },
    "20": { "weight": 1.4, "avgEngagement": 750, "samples": 28 }
  },
  "lastUpdated": "2026-02-03T23:59:00Z"
}
```

### Estrutura do learnings.json

```json
{
  "hooks": {
    "extreme": { "weight": 1.3, "uses": 45, "totalEngagement": 12500 },
    "aida": { "weight": 1.1, "uses": 38, "totalEngagement": 9200 },
    "pas": { "weight": 0.9, "uses": 42, "totalEngagement": 8100 }
  },
  "styles": {
    "hot_take": { "weight": 1.4, "uses": 52, "totalEngagement": 15800 },
    "sarcasm": { "weight": 1.2, "uses": 35, "totalEngagement": 9500 }
  },
  "topics": {
    "crypto": { "weight": 1.3, "uses": 120, "totalEngagement": 45000 },
    "ai": { "weight": 1.1, "uses": 120, "totalEngagement": 38000 }
  },
  "lastLearning": "2026-02-03T23:59:00Z",
  "totalDays": 15
}
```

### Comandos V2

```bash
# Ciclo completo de aprendizado (coleta + analise + ajuste)
npm run learn

# Apenas coleta de metricas
npm run collect

# Health check do sistema
npm run health

# Reinicia daemon aplicando novos pesos
npm run restart

# Ver relatorio do dia
npm run report

# Ver progresso vs metas
npm run goals

# Testar analise sem salvar
npm run learn:dry
```

### Metricas Rastreadas

| Metrica | Fonte | Frequencia | Meta |
|---------|-------|------------|------|
| Impressoes/dia | X Analytics | Diario | 55k/dia |
| Engagement rate | Calculado | Por post | >2% |
| Premium followers | X Creator Studio | Diario | 500 em 90d |
| Verified followers | X Creator Studio | Diario | 2,000 em 90d |
| Hook performance | learnings.json | Diario | Top 3 identificados |
| Style performance | learnings.json | Diario | Top 3 identificados |
| Best hours | engagement-hours.json | Semanal | Top 3 horarios |

### Relatorio Diario no Telegram

```
=== RELATORIO DIARIO (02/02/2026) ===

IMPRESSOES: 62,450 / 55,556 meta (+12.4%)
ENGAJAMENTO: 2.8% (media: 2.1%)
FOLLOWERS: +12 (8 premium, 4 verified)

TOP HOOKS HOJE:
1. extreme (1,850 eng/post)
2. bab (1,420 eng/post)
3. results (1,380 eng/post)

TOP STYLES HOJE:
1. hot_take (2,100 eng/post)
2. contrarian (1,650 eng/post)
3. personal (1,400 eng/post)

TOP HORARIOS:
1. 18h (820 avg engagement)
2. 20h (750 avg engagement)
3. 16h (650 avg engagement)

PROGRESSO METAS:
- Impressoes: 842k / 5M (16.8%) - 12 dias
- Premium: 68 / 500 (13.6%)
- Verified: 245 / 2,000 (12.3%)

AJUSTES APLICADOS:
- extreme: 1.2 -> 1.3 (+8.3%)
- hot_take: 1.3 -> 1.4 (+7.7%)
- 18h: 1.4 -> 1.5 (+7.1%)
```

### Fluxo do Aprendizado V2

```
┌──────────────────┐     ┌──────────────────┐     ┌──────────────────┐
│   Dia N: Posts   │────>│  23:59: Coleta   │────>│  Analise Claude  │
│  com pesos atuais│     │    metricas      │     │   identifica     │
└──────────────────┘     └──────────────────┘     │   padroes        │
                                                   └────────┬─────────┘
                                                            │
                                                            ▼
┌──────────────────┐     ┌──────────────────┐     ┌──────────────────┐
│ Dia N+1: Posts   │<────│ 00:05: Daemon    │<────│ Ajuste de Pesos  │
│ com novos pesos  │     │    restart       │     │   automatico     │
└──────────────────┘     └──────────────────┘     └──────────────────┘
```

### Integracao com Sistema V1

O sistema V2 e **retro-compativel** com V1:

- Se `data/learnings.json` nao existir, usa pesos iguais (1.0)
- Se `data/engagement-hours.json` nao existir, usa horarios fixos
- Comandos V1 (`npm run start`, `npm run analyze`) continuam funcionando
- Daemon V1 pode coexistir com V2 (mas recomenda-se usar apenas V2)

## Notas de Desenvolvimento

- Posts max 500 chars
- Digitacao humanizada: 70-130ms entre chars, pausas apos pontuacao
- 60 segundos entre posts multiplos
- Retry automatico: 3 tentativas na conexao Chrome, 2 no post
- Cache: 30 min fresco, 4h stale para fallback

## Premissas e Licoes Aprendidas

### Insercao de Texto no X (IMPORTANTE)
| Metodo | Funciona? | Problema |
|--------|-----------|----------|
| `execCommand('insertText')` em chunks | NAO | Cada chunk sobrescreve o anterior |
| `keyboard.type()` char por char | SIM (lento) | ~100ms por char, OK para fallback |
| **Clipboard (Cmd+V)** | **SIM** | **Metodo principal - mais confiavel** |

**SEMPRE usar clipboard para textos longos.** A insercao via DOM em chunks perde texto.

### Funcoes Sync vs Async (Node.js)
| Funcao | Tipo | Tem .catch()? |
|--------|------|---------------|
| `fs.unlinkSync()` | Sync | NAO - usar try/catch |
| `fs.unlink()` | Async (callback) | NAO - usar promisify |
| `fs.promises.unlink()` | Async (Promise) | SIM |

**NUNCA usar `.catch()` em funcoes sync.** Causa crash silencioso.

### Daemon e Hot Reload
- Daemon usa `spawn()` para executar scripts
- Codigo e carregado do disco A CADA execucao
- **NAO precisa reiniciar daemon** apos editar `auto-post.js` ou `puppeteer-post.js`
- So reiniciar se editar `cron-daemon.js` (o proprio daemon)

### Verificacao de Posts
Sempre logar no puppeteer-post.js:
1. Quantos chars foram inseridos vs esperado
2. Primeiros 100 chars do texto final (para debug)
3. Se texto < 80% do esperado, avisar antes de postar

## Historico de Commits
- **2026-02-03 20:09** [`3cce8fb`] Document self-learning system in CLAUDE.md (.claude/CLAUDE.md)
- **2026-02-03 20:09** [`1ec2efe`] Add Hook Frameworks + Self-Learning Analytics System (.claude/CLAUDE.md,package.json,scripts/auto-post-v2.js,scripts/cron-daemon-v2.js,scripts/daily-analysis.js)
- **2026-02-03** Document Hook Frameworks: 8 styles x 8 hooks = 64 combinations (.claude/CLAUDE.md)
- **2026-02-02 19:13** [`5b070e7`] Document lessons learned: clipboard for text, sync vs async, hot reload (.claude/CLAUDE.md)
- **2026-02-02 19:07** [`3f7b9c5`] Fix text truncation: use clipboard instead of chunked DOM insert (src/puppeteer-post.js)
- **2026-02-02 16:33** [`bc9f5ba`] Fix daemon crash: unlinkSync is sync, not async (scripts/cron-daemon.js)
- **2026-02-02 09:55** [`9f07b6a`] Add multi-source bilingual posting system (v2) (.gitignore,scripts/auto-post-v2.js,scripts/cron-daemon-v2.js,scripts/test-curate-v3.js,scripts/test-generate-v2.js)
- **2026-01-31 14:24** [`68b36b1`] Update CLAUDE.md commit history (.claude/CLAUDE.md)
- **2026-01-31 13:19** [`595d0e1`] Add singleton check to prevent duplicate daemon instances (scripts/cron-daemon.js)
- **2026-01-31 11:07** [`c2e5217`] Change schedule from Mon-Fri to Mon-Sat (1-6) (.claude/CLAUDE.md,scripts/cron-daemon.js)
- **2026-01-31 09:11** [`df9c934`] Document curadoria v2 with hashtags, authors, mentions in CLAUDE.md (.claude/CLAUDE.md)
- **2026-01-31 09:07** [`99e6329`] Improve curate-v2: add authors, hashtags, mentions + optimize rate limits (scripts/test-curate-v2.js,src/curate-v2.js)
- **2026-01-30 21:34** [`4afae02`] Update CLAUDE.md with commit history from hook (.claude/CLAUDE.md)
- **2026-01-30 21:32** [`a5e3a5a`] Add post-commit hook to track changes in CLAUDE.md (.claude/CLAUDE.md,.claude/hooks/post-commit-summary.sh)

- **2026-01-30 19:56** [`f820a89`] Add curate-v2 with real-time data and fix daemon issues (src/curate-v2.js, scripts/auto-post.js, src/puppeteer-post.js, scripts/cron-daemon.js, .claude/CLAUDE.md)
- **2026-01-30 15:32** [`b8ce216`] Add anti-suspension measures for Chrome timeout issues
- **2026-01-30 14:23** [`2325973`] Fix first post failure by navigating to /home before posting
